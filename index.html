<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Housemates</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <script type="text/JavaScript" src="js/jquery-1.11.0.min.js"></script>       
    <script type="text/JavaScript" src="js/submit.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
    <script src="http://listjs.com/no-cdn/list.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="navbar navbar-inverse narbar-fixed-top" role="navigation">
      <div class="container">
        <div class ="navbar-header"
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <div class ="navbar-brand"> Housemates </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="row">
          <div class="col-md-4">
              <div id="contacts">
                <div class="table-responsive">
                  <table class="table table-hover">
                    <thead>
                      <tr>
                        <h3>List of Housemates<small><br>Add, update or remove your housemates!</small></h3>
                      </tr>
                    </thead>
                    <tbody class="list">
                      <tr>
                        <td class="id" style="display:none;">1</td>
                        <td class="name">Jonny</td>
                        <td class="edit"><button class="btn btn-link edit-item-btn"><span class="glyphicon glyphicon-pencil"></span></button></td>
                        <td class="remove"><button class="btn btn-link remove-item-btn"><span class="glyphicon glyphicon-trash"></span></button></td>
                      </tr>
                    </tbody>
                  </table>
                  <table>
                    <td class="name">
                      <input type="hidden" id="id-field" />
                      <input type="text" id="name-field" placeholder="Name" />
                    </td>
                    <td class="add">
                      <button id="add-btn" class="btn btn-link"><span class="glyphicon glyphicon-plus"></span></button>  
                      <button id="edit-btn" class="btn btn-link"><span class="glyphicon glyphicon-ok  "></span></button>
                    </td>
                  </table>
                <div class="table-responsive">         
              </div>
            </div>
          </div>    
        </div>
            <div class="col-md-6">
              <h3>List of Chores<small><br>Add, update or remove the list of chores!</small></h3>
                <div class="table-responsive">
                  <div id="chorelistrotational">                  
                  <table class="table table-hover">
                    <tbody class="list" id="customize">
                        <tr>
                          <td class="id2" style="display:none;">1</td>
                          <td class="chore">Kitchen</td>
                          <td class="time">Bi-weekly</td>                             
                          <td class="edit"><button class="btn btn-link edit-chore-item-btn"><span class="glyphicon glyphicon-pencil"></span></button></td>
                          <td class="remove"><button class="btn btn-link remove-chore-item-btn"><span class="glyphicon glyphicon-trash"></span></button></td>
                        </tr>
                    </tbody>
                  </table>
                </div>
                <div id="chorelistfixed">
                  <table class="table table-hover">                           
                    <tbody class="list" id="standard">
                       <tr>
                          <td class="id2" style="display:none;">1</td>
                          <td class="chore">Kitchen</td>
                          <td class="time">Bi-weekly</td>
                          <td class="assign">Jonny</td>                             
                          <td class="edit"><button class="btn btn-link edit-chore-item-btn"><span class="glyphicon glyphicon-pencil"></span></button></td>
                          <td class="remove"><button class="btn btn-link remove-chore-item-btn"><span class="glyphicon glyphicon-trash"></span></button></td>
                        </tr>
                      </div>
                    </tbody>
                  </table>
                </div>      
                  <table>
                    <td>
                      <div id="assign">
                        <select id="selectNumber" class="form-control">
                          <option>Assign a housemate to</option>
                        </select>
                      </div>
                    </td>                    
                    <td class="chore">
                      <input type="hidden" id="id-chore-field"/>
                      <input type="text" id="chore-field" placeholder="Chore"/>
                    </td>
                    <td>
                      <select class="form-control" id="time-field">
                          <option value="Weekly">Weekly</option>
                          <option value="Bi-Weekly">Bi-Weekly</option>
                          <option value="Monthly">Monthly</option>  
                      </select>
                    </td>
                    <td class="add">
                      <button id="add-chore-btn" class="btn btn-link"><span class="glyphicon glyphicon-plus"></span></button>  
                      <button id="edit-chore-btn" class="btn btn-link"><span class="glyphicon glyphicon-ok"></span></button>
                    </td>
                  </table>      
              </div>
          </div>
          <div class="col-md-4">
            <h3>Choose a type of Schedule</h3>
            <div class="radio">
              <label>
                <input type="radio" name="optionsRadios" id="customize_1" onClick="toggleTables('2'), hideAssign()" value="option1">
                <h4>Rotational Schedule <small>A schedule that rotates based on the timeframe of a given chore</small></h4>
              </label>
            </div>
            <div class="radio">
              <label>
                <input type="radio" name="optionsRadios" id="standard_1" onClick="toggleTables('1'), showAssign()" value="option2" checked>
                <h4>Fixed Schedule <small>A schedule that is fixed and as housemates assign to</small></h4>
              </label>
            </div>
          </div>  
      </div>
    </div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>

    <script type=text/javascript>
      function toggleTables(which)
      {
          var isCustomize = document.getElementById('customize_1').checked; 
          var isStandard = document.getElementById('standard_1').checked;  
          
          var customize = document.getElementById('customize'); 
          var standard = document.getElementById('standard');    
             
          customize.style.display = isCustomize  ? 'table' : 'none';
          standard.style.display = isStandard  ? 'table' : 'none';
      }

      function showAssign(){
              document.getElementById("assign").style.visibility = "visible";
      }
      function hideAssign(){
              document.getElementById("assign").style.visibility = "hidden";
      }


      var housemateOptions = {
          valueNames: [ 'id', 'name']
        };

      var choreRotationalOptions = {
          valueNames: [ 'id2','chore', 'time']
        };

      var choreFixedOptions = {
          valueNames: [ 'id2','chore', 'time', 'assign']
        };      

        // Init list
        var contactList = new List('contacts', housemateOptions);
        var choreListRotational = new List('chorelistrotational', choreRotationalOptions);
        var choreListFixed = new List('chorelistfixed', choreFixedOptions);

        var idField = $('#id-field'),
            nameField = $('#name-field'),
            addBtn = $('#add-btn'),
            editBtn = $('#edit-btn').hide(),
            removeBtns = $('.remove-item-btn'),
            editBtns = $('.edit-item-btn'),
            idChoreField = $('#id-chore-field'),
            choreField = $('#chore-field'),
            timeField = $('#time-field'),
            addChoreBtn = $('#add-chore-btn'),
            editChoreBtn = $('#edit-chore-btn').hide(),
            removeChoreBtns = $('.remove-chore-item-btn'),
            editChoreBtns = $('.edit-chore-item-btn'); 

        var nextHousemateId = 3;
        var nextChoreId = 3;
        var housemates = ['Jonny'];       
        // Sets callbacks to the buttons in the list
        refreshHousemateCallbacks();
        refreshChoreCallbacks();

        //Add Butttons
        addBtn.click(function() {
          contactList.add({
            id: Math.floor(nextHousemateId + 1),
            name: nameField.val(),
          });
          housemates.push(nameField.val());
          clearHousemateFields();
          refreshHousemateCallbacks();
          nextHousemateId = Math.floor(nextHousemateId + 1);
        });

        addChoreBtn.click(function() {
          choreListRotational.add({
            id2: Math.floor(nextChoreId + 1),
            chore: choreField.val(),
            time: timeField.val(),
            assign: nameField.val()            
          });
          choreListFixed.add({
            id2: Math.floor(nextChoreId + 1),
            chore: choreField.val(),
            time: timeField.val(),
            assign: nameField.val()
          });          
          clearChoreFields();
          refreshChoreCallbacks();
          nextChoreId = Math.floor(nextChoreId + 1);
        });        

        //Edit Buttons
        editBtn.click(function() {
          var item = contactList.get('id', idField.val())[0];
          item.values({
            id:idField.val(),
            name: nameField.val()
          });
          clearHousemateFields();
          editBtn.hide();
          addBtn.show();
        });

        editChoreBtn.click(function() {
          var item = choreListRotational.get('id2', idChoreField.val())[0];
          item.values({
            id2:idChoreField.val(),
            chore:choreField.val(),
            time:timeField.val(),
          });
          clearChoreFields();
          editChoreBtn.hide();
          addChoreBtn.show();
        });
   

        function refreshHousemateCallbacks() {
          // Needed to add new buttons to jQuery-extended object
          removeBtns = $(removeBtns.selector);
          editBtns = $(editBtns.selector);
          
          removeBtns.click(function() {
            var itemId = $(this).closest('tr').find('.id').text();
            contactList.remove('id', itemId);
          });
          
          editBtns.click(function() {
            var itemId = $(this).closest('tr').find('.id').text();
            var itemValues = contactList.get('id', itemId)[0].values();
            idField.val(itemValues.id);
            nameField.val(itemValues.name);
    
            editBtn.show();
            addBtn.hide();
          });
        }

        function refreshChoreCallbacks() {
          // Needed to add new buttons to jQuery-extended object
          removeChoreBtns = $(removeChoreBtns.selector);
          editChoreBtns = $(editChoreBtns.selector);
          
          removeChoreBtns.click(function() {
            var itemId = $(this).closest('tr').find('.id2').text();
            choreListRotational.remove('id2', itemId);
            choreListFixed.remove('id2',itemId);
          });
          
          editChoreBtns.click(function() {
            var itemId = $(this).closest('tr').find('.id2').text();
            var itemValues = choreList.get('id2', itemId)[0].values();
            idChoreField.val(itemValues.id2);
            choreField.val(itemValues.chore);
            timeField.val(itemValues.time);
            
            editChoreBtn.show();
            addChoreBtn.hide();
          });
        }        

        function clearHousemateFields() {
          nameField.val('');
        }

        function clearChoreFields() {
          choreField.val('');
          timeField.val('');
        }

    </script>
  </body>
</html>