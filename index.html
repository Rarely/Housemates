<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Housemates</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <script type="text/JavaScript" src="js/jquery-1.11.0.min.js"></script>       
    <script type="text/JavaScript" src="js/submit.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
    <script src="http://listjs.com/no-cdn/list.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="navbar navbar-inverse narbar-fixed-top" role="navigation">
      <div class="container">
        <div class ="navbar-header"
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <div class ="navbar-brand"> Housemates </div>
        </div>
      </div>
    </div>

    <div class= "jumbotron">
      <div class="container">
        <h2> Welcome to Housemates Jim!</h2>
        <p>  This is a template for a simple marketing or informational website. It includes a large callout called a jumbotron and three supporting pieces of content. Use it as a starting point to create something more unique.
        </p>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-md-8">
          <div class="col-md-4">
              <div id="contacts">
                <table>
                  <thead>
                    <tr>
                      <th class="sort" data-sort="name">Name</th>
                      <th colspan="2">
                        <input type="text" class="search" placeholder="Search contact" />
                      </th>
                    </tr>
                  </thead>
                  <tbody class="list">
                    <tr>
                      <td class="id" style="display:none;">1</td>
                      <td class="name">Jonny</td>
                      <td class="edit"><button class="edit-item-btn">Edit</button></td>
                      <td class="remove"><button class="remove-item-btn">Remove</button></td>
                    </tr>
                    <tr>
                      <td class="id" style="display:none;">2</td>
                      <td class="name">Jonas</td>
                      <td class="edit"><button class="edit-item-btn">Edit</button></td>
                      <td class="remove"><button class="remove-item-btn">Remove</button></td>
                    </tr>
                    <tr>
                      <td class="id" style="display:none;">3</td>
                      <td class="name">Gustaf</td>
                      <td class="edit"><button class="edit-item-btn">Edit</button></td>
                      <td class="remove"><button class="remove-item-btn">Remove</button></td>
                    </tr>
                    <tr>
                      <td class="id" style="display:none;">4</td>
                      <td class="name">Fredrik</td>
                      <td class="edit"><button class="edit-item-btn">Edit</button></td>
                      <td class="remove"><button class="remove-item-btn">Remove</button></td>
                    </tr>
                  </tbody>
                </table>
                <table>
                  <td class="name">
                    <input type="hidden" id="id-field" />
                    <input type="text" id="name-field" placeholder="Name" />
                  </td>
                  <td class="add">
                    <button id="add-btn">Add</button>
                    <button id="edit-btn">Edit</button>
                  </td>
                </table>
              </div>
            </div>
          </div>    
        </div>
      </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>

    <script type="text/javascript">
      var options = {
          valueNames: [ 'id', 'name']
        };

        // Init list
        var contactList = new List('contacts', options);

        var idField = $('#id-field'),
            nameField = $('#name-field'),
            ageField = $('#age-field'),
            cityField = $('#city-field'),
            addBtn = $('#add-btn'),
            editBtn = $('#edit-btn').hide(),
            removeBtns = $('.remove-item-btn'),
            editBtns = $('.edit-item-btn');

        // Sets callbacks to the buttons in the list
        refreshCallbacks();

        addBtn.click(function() {
          contactList.add({
            id: Math.floor(Math.random()*110000),
            name: nameField.val(),
            age: ageField.val(),
            city: cityField.val()
          });
          clearFields();
          refreshCallbacks();
        });

        editBtn.click(function() {
          var item = contactList.get('id', idField.val())[0];
          item.values({
            id:idField.val(),
            name: nameField.val(),
            age: ageField.val(),
            city: cityField.val()
          });
          clearFields();
          editBtn.hide();
          addBtn.show();
        });

        function refreshCallbacks() {
          // Needed to add new buttons to jQuery-extended object
          removeBtns = $(removeBtns.selector);
          editBtns = $(editBtns.selector);
          
          removeBtns.click(function() {
            var itemId = $(this).closest('tr').find('.id').text();
            contactList.remove('id', itemId);
          });
          
          editBtns.click(function() {
            var itemId = $(this).closest('tr').find('.id').text();
            var itemValues = contactList.get('id', itemId)[0].values();
            idField.val(itemValues.id);
            nameField.val(itemValues.name);
            ageField.val(itemValues.age);
            cityField.val(itemValues.city);
            
            editBtn.show();
            addBtn.hide();
          });
        }

        function clearFields() {
          nameField.val('');
          ageField.val('');
          cityField.val('');
        }
    </script>
  </body>
</html>